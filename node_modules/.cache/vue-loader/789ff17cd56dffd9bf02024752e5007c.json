{"remainingRequest":"/Users/engram/Documents/Web_apps/ap-study-bites-admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/engram/Documents/Web_apps/ap-study-bites-admin/src/components/AddTopic/AddTopicForm.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/engram/Documents/Web_apps/ap-study-bites-admin/src/components/AddTopic/AddTopicForm.vue","mtime":1642481804279},{"path":"/Users/engram/Documents/Web_apps/ap-study-bites-admin/node_modules/cache-loader/dist/cjs.js","mtime":1640582283784},{"path":"/Users/engram/Documents/Web_apps/ap-study-bites-admin/node_modules/babel-loader/lib/index.js","mtime":1640582283745},{"path":"/Users/engram/Documents/Web_apps/ap-study-bites-admin/node_modules/cache-loader/dist/cjs.js","mtime":1640582283784},{"path":"/Users/engram/Documents/Web_apps/ap-study-bites-admin/node_modules/vue-loader/lib/index.js","mtime":1640582283219}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcEFjdGlvbnMgfSBmcm9tICJ2dWV4IjsKaW1wb3J0IHsgbWFwRmllbGRzIH0gZnJvbSAidnVleC1tYXAtZmllbGRzIjsKaW1wb3J0IGZpcmViYXNlIGZyb20gImZpcmViYXNlIjsKaW1wb3J0IEhlYWRlciBmcm9tICIuLi9EYXNoYm9hcmRIZWFkZXJzLnZ1ZSI7CgpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogeyBIZWFkZXIgfSwKICBkYXRhOiAoKSA9PiAoewogICAgaW1hZ2U6IG51bGwsCiAgICB0aW1lUGVyaW9kQ2hvaWNlczogWzEsIDIsIDMsIDRdLAogICAgZGlzYWJsZWQ6IDEsCiAgICB1cmw6IG51bGwsCiAgICBjYXB0aW9uOiAiIiwKICAgIGltZzE6ICIiLAogICAgaW1hZ2VEYXRhOiBudWxsLAogIH0pLAogIGNvbXB1dGVkOiB7CiAgICBzZWxlY3RzUGVyaW9kKCkgewogICAgICByZXR1cm4gdGhpcy5zZWxlY3RlZFBlcmlvZC5sZW5ndGggPiAwOwogICAgfSwKICAgIGljb24oKSB7CiAgICAgIGlmICh0aGlzLnNlbGVjdHNQZXJpb2QpIHJldHVybiAibWRpLW1pbnVzLWJveCI7CiAgICAgIHJldHVybiAibWRpLWNoZWNrYm94LWJsYW5rLW91dGxpbmUiOwogICAgfSwKICAgIGNoZWNrZmllbGQoKSB7CiAgICAgIHJldHVybiB0aGlzLnRpdGxlIHx8IHRoaXMuaW1hZ2UgfHwgdGhpcy5zZWxlY3RlZFBlcmlvZDsKICAgIH0sCiAgICAuLi5tYXBGaWVsZHMoInRvcGljcyIsIFsKICAgICAgImN1cnJlbnRUb3BpYy50aXRsZSIsCiAgICAgICJjdXJyZW50VG9waWMuaW50cm9NRCIsCiAgICAgICJjdXJyZW50VG9waWMuaW50cm9fdGh1bWJGaWxlIiwKICAgICAgImN1cnJlbnRUb3BpYy5pbnRyb190aHVtYlVSTCIsCiAgICAgICJjdXJyZW50VG9waWMudG9waWNfdGh1bWJGaWxlIiwKICAgICAgImN1cnJlbnRUb3BpYy50b3BpY190aHVtYlVSTCIsCiAgICAgIC8vICdjdXJyZW50VG9waWMuZGlzYWJsZWQnLAogICAgICAiY3VycmVudFRvcGljLnRpbWVQZXJpb2QiLAogICAgICAiY3VycmVudFRvcGljLnNlYXJjaEFycmF5IiwKICAgIF0pLAogIH0sCgogIG1ldGhvZHM6IHsKICAgIC4uLm1hcEFjdGlvbnMoInRvcGljcyIsIFsic3VibWl0TmV3VG9waWMiLCAiY2xlYXJGaWVsZHMiLCAiY2xlYXJUb3BpY0lkIl0pLAogICAgdG9nZ2xlKCkgewogICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgdGhpcy5zZWxlY3RlZFBlcmlvZCA9IFt0aGlzLnRpbWVQZXJpb2Quc2xpY2UoKV07CiAgICAgIH0pOwogICAgfSwKICAgIGNsZWFySW5wdXQoKSB7CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJpbWdpbnB1dCIpLnZhbHVlID0gIiI7CiAgICB9LAogICAgcHJldmlld0ltYWdlKGUpIHsKICAgICAgdGhpcy51cGxvYWRWYWx1ZSA9IDA7CiAgICAgIGNvbnNvbGUubG9nKGUudGFyZ2V0LmZpbGVzWzBdKTsKICAgICAgbGV0IGZpbGUgPSBlLnRhcmdldC5maWxlc1swXTsKICAgICAgbGV0IGZpbGVTaXplID0gZmlsZS5zaXplIC8gMTAyNCAvIDEwMjQ7CiAgICAgIGlmIChmaWxlU2l6ZSA+IDIpIHsKICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgdGhpcy5jbGVhcklucHV0KCk7CiAgICAgICAgYWxlcnQoIkZpbGUgaXMgb3ZlciAybWIiKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnVybCA9IFVSTC5jcmVhdGVPYmplY3RVUkwoZmlsZSk7CiAgICAgICAgdGhpcy5pbWFnZURhdGEgPSBlLnRhcmdldC5maWxlc1swXTsKICAgICAgICB0aGlzLnRvcGljX3RodW1iRmlsZSA9IGZpbGUubmFtZTsKICAgICAgfQogICAgfSwKICAgIG9uVXBsb2FkKCkgewogICAgICBjb25zdCBzdG9yYWdlUmVmID0gZmlyZWJhc2UKICAgICAgICAuc3RvcmFnZSgpCiAgICAgICAgLnJlZihgJHt0aGlzLmltYWdlRGF0YS5uYW1lfWApCiAgICAgICAgLnB1dCh0aGlzLmltYWdlRGF0YSk7CiAgICAgIHN0b3JhZ2VSZWYub24oCiAgICAgICAgYHN0YXRlX2NoYW5nZWRgLAogICAgICAgIChzbmFwc2hvdCkgPT4gewogICAgICAgICAgdGhpcy51cGxvYWRWYWx1ZSA9CiAgICAgICAgICAgIChzbmFwc2hvdC5ieXRlc1RyYW5zZmVycmVkIC8gc25hcHNob3QudG90YWxCeXRlcykgKiAxMDA7CiAgICAgICAgfSwKICAgICAgICAoZXJyb3IpID0+IHsKICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yLm1lc3NhZ2UpOwogICAgICAgIH0sCiAgICAgICAgYXN5bmMgKCkgPT4gewogICAgICAgICAgdGhpcy51cGxvYWRWYWx1ZSA9IDEwMDsKICAgICAgICAgIGF3YWl0IHN0b3JhZ2VSZWYuc25hcHNob3QucmVmLmdldERvd25sb2FkVVJMKCkudGhlbigodXJsKSA9PiB7CiAgICAgICAgICAgIC8vIHRoaXMuaW1nMSA9IHVybDsKICAgICAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy5pbWcxKTsKICAgICAgICAgICAgdGhpcy50b3BpY190aHVtYlVSTCA9IHVybDsKICAgICAgICAgICAgY29uc29sZS5sb2codGhpcy50b3BpY190aHVtYlVSTCk7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICApOwogICAgfSwKICAgIGFzeW5jIGhhbmRsZVN1Ym1pdE5ld1RvcGljKCkgewogICAgICBpZiAodGhpcy5pbWFnZURhdGEpIHsKICAgICAgICBsZXQgaW1nUHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZSh0aGlzLm9uVXBsb2FkKCkpOwogICAgICAgIGF3YWl0IGltZ1Byb21pc2UudGhlbihhc3luYyAoKSA9PiB7CiAgICAgICAgICBzZXRUaW1lb3V0KGFzeW5jICgpID0+IHsKICAgICAgICAgICAgYXdhaXQgdGhpcy5zdWJtaXROZXdUb3BpYygpOwogICAgICAgICAgfSwgMjAwMCk7CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy50b3BpY190aHVtYkZpbGUgPSAicGxhY2VIb2xkZXJJbWcucG5nIjsKICAgICAgICB0aGlzLnRvcGljX3RodW1iVVJMID0KICAgICAgICAgICJodHRwczovL2ZpcmViYXNlc3RvcmFnZS5nb29nbGVhcGlzLmNvbS92MC9iL3N0dWR5LWJpdGVzLTEuYXBwc3BvdC5jb20vby9wbGFjZUhvbGRlckltZy5wbmc/YWx0PW1lZGlhJnRva2VuPTM4ZWNlZDA3LTU0YTQtNGIzYS1iMmY5LTQ5ZmE4ZTAxZGE2MyI7CgogICAgICAgIHNldFRpbWVvdXQoYXN5bmMgKCkgPT4gewogICAgICAgICAgYXdhaXQgdGhpcy5zdWJtaXROZXdUb3BpYygpOwogICAgICAgIH0sIDIwMDApOwogICAgICB9CiAgICB9LAogICAgcmVzZXRGaWVsZHMoKSB7CiAgICAgIHRoaXMudGl0bGUgPSAiIjsKICAgICAgdGhpcy50aW1lUGVyaW9kID0gW107CiAgICAgIHRoaXMudXJsID0gbnVsbDsKICAgICAgdGhpcy5pbWFnZURhdGEgPSBudWxsOwogICAgICB0aGlzLmNsZWFySW5wdXQoKTsKICAgICAgdGhpcy5jbGVhckZpZWxkcygpOwogICAgICB0aGlzLmNsZWFyVG9waWNJZCgpOwogICAgfSwKICB9LAogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmNsZWFyRmllbGRzKCk7CiAgICB0aGlzLmNsZWFyVG9waWNJZCgpOwogIH0sCn07Cg=="},{"version":3,"sources":["AddTopicForm.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2EA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"AddTopicForm.vue","sourceRoot":"src/components/AddTopic","sourcesContent":["<template>\n  <div id=\"addTopic\">\n    <v-container>\n      <Header\n        v-bind:header=\"'Adding New Topic'\"\n        v-bind:description=\"\n          'Add a new topic to the Engram home page by filling in basic information.'\n        \"\n        v-bind:links=\"[]\"\n      />\n      <v-row>\n        <v-col cols=\"6\" class=\"pt-10\">\n          <div class=\"d-flex align-end\">\n            <v-card width=\"200\" height=\"150\" color=\"grey lighten-2\" outlined>\n              <v-img v-if=\"url\" :src=\"url\" height=\"100%\" width=\"100%\"></v-img>\n            </v-card>\n            <input\n              id=\"imginput\"\n              class=\"pl-4\"\n              ref=\"input1\"\n              type=\"file\"\n              @change=\"previewImage\"\n            />\n          </div>\n\n          <v-text-field\n            label=\"Topic title:\"\n            background-color=\"grey lighten-2\"\n            v-model=\"title\"\n            outlined\n            dense\n            class=\"pt-5\"\n          ></v-text-field>\n          <v-select\n            v-model=\"timePeriod\"\n            :items=\"timePeriodChoices\"\n            label=\"Time Period\"\n            background-color=\"grey lighten-2\"\n            outlined\n            dense\n            class=\"pt-5\"\n          >\n          </v-select>\n        </v-col>\n      </v-row>\n      <v-row>\n        <v-col>\n          <div class=\"d-flex justify-end pr-12\">\n            <v-btn\n              class=\"white--text\"\n              width=\"140\"\n              color=\"#3891A6\"\n              :disabled=\"!checkfield\"\n              elevation=\"2\"\n              @click=\"resetFields\"\n              >Reset</v-btn\n            >\n          </div>\n          <div class=\"d-flex justify-end pr-12 pt-4\">\n            <v-btn\n              class=\"white--text\"\n              width=\"140\"\n              color=\"#3891A6\"\n              elevation=\"2\"\n              @click=\"handleSubmitNewTopic\"\n              >Save</v-btn\n            >\n          </div>\n        </v-col>\n      </v-row>\n    </v-container>\n  </div>\n</template>\n\n<script>\nimport { mapActions } from \"vuex\";\nimport { mapFields } from \"vuex-map-fields\";\nimport firebase from \"firebase\";\nimport Header from \"../DashboardHeaders.vue\";\n\nexport default {\n  components: { Header },\n  data: () => ({\n    image: null,\n    timePeriodChoices: [1, 2, 3, 4],\n    disabled: 1,\n    url: null,\n    caption: \"\",\n    img1: \"\",\n    imageData: null,\n  }),\n  computed: {\n    selectsPeriod() {\n      return this.selectedPeriod.length > 0;\n    },\n    icon() {\n      if (this.selectsPeriod) return \"mdi-minus-box\";\n      return \"mdi-checkbox-blank-outline\";\n    },\n    checkfield() {\n      return this.title || this.image || this.selectedPeriod;\n    },\n    ...mapFields(\"topics\", [\n      \"currentTopic.title\",\n      \"currentTopic.introMD\",\n      \"currentTopic.intro_thumbFile\",\n      \"currentTopic.intro_thumbURL\",\n      \"currentTopic.topic_thumbFile\",\n      \"currentTopic.topic_thumbURL\",\n      // 'currentTopic.disabled',\n      \"currentTopic.timePeriod\",\n      \"currentTopic.searchArray\",\n    ]),\n  },\n\n  methods: {\n    ...mapActions(\"topics\", [\"submitNewTopic\", \"clearFields\", \"clearTopicId\"]),\n    toggle() {\n      this.$nextTick(() => {\n        this.selectedPeriod = [this.timePeriod.slice()];\n      });\n    },\n    clearInput() {\n      document.getElementById(\"imginput\").value = \"\";\n    },\n    previewImage(e) {\n      this.uploadValue = 0;\n      console.log(e.target.files[0]);\n      let file = e.target.files[0];\n      let fileSize = file.size / 1024 / 1024;\n      if (fileSize > 2) {\n        e.preventDefault();\n        this.clearInput();\n        alert(\"File is over 2mb\");\n      } else {\n        this.url = URL.createObjectURL(file);\n        this.imageData = e.target.files[0];\n        this.topic_thumbFile = file.name;\n      }\n    },\n    onUpload() {\n      const storageRef = firebase\n        .storage()\n        .ref(`${this.imageData.name}`)\n        .put(this.imageData);\n      storageRef.on(\n        `state_changed`,\n        (snapshot) => {\n          this.uploadValue =\n            (snapshot.bytesTransferred / snapshot.totalBytes) * 100;\n        },\n        (error) => {\n          console.log(error.message);\n        },\n        async () => {\n          this.uploadValue = 100;\n          await storageRef.snapshot.ref.getDownloadURL().then((url) => {\n            // this.img1 = url;\n            // console.log(this.img1);\n            this.topic_thumbURL = url;\n            console.log(this.topic_thumbURL);\n            return true;\n          });\n        }\n      );\n    },\n    async handleSubmitNewTopic() {\n      if (this.imageData) {\n        let imgPromise = Promise.resolve(this.onUpload());\n        await imgPromise.then(async () => {\n          setTimeout(async () => {\n            await this.submitNewTopic();\n          }, 2000);\n        });\n      } else {\n        this.topic_thumbFile = \"placeHolderImg.png\";\n        this.topic_thumbURL =\n          \"https://firebasestorage.googleapis.com/v0/b/study-bites-1.appspot.com/o/placeHolderImg.png?alt=media&token=38eced07-54a4-4b3a-b2f9-49fa8e01da63\";\n\n        setTimeout(async () => {\n          await this.submitNewTopic();\n        }, 2000);\n      }\n    },\n    resetFields() {\n      this.title = \"\";\n      this.timePeriod = [];\n      this.url = null;\n      this.imageData = null;\n      this.clearInput();\n      this.clearFields();\n      this.clearTopicId();\n    },\n  },\n  created() {\n    this.clearFields();\n    this.clearTopicId();\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped></style>\n"]}]}